<!DOCTYPE html>
<html>
<head>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css">
    <title>Rap Live</title>
    <link rel="stylesheet" type="text/css" href="style.css">

    <link href="https://afeld.github.io/emoji-css/emoji.css" rel="stylesheet">

    <meta name="viewport" content="width=device-width">

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.0/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="https://api.bistri.com/bistri.conference.min.js"></script>

    <script type="text/javascript">
        /*
        JS library reference:
        http://developers.bistri.com/webrtc-sdk/js-library-reference
        */
        
        var room;
        var members;
        var localStream;
        
        // when Bistri API client is ready, function
        // "onBistriConferenceReady" is invoked
        onBistriConferenceReady = function () {
        
        // test if the browser is WebRTC compatible
        if ( !bc.isCompatible() ) {
        // if the browser is not compatible, display an alert
        alert( "your browser is not WebRTC compatible !" );
        // then stop the script execution
        return;
        }
        
        // initialize API client with application keys
        // https://api.developers.bistri.com/login
        bc.init( {
        "appId": "7a5eebc7",
        "appKey": "4465c0d6fb1f64b3d870e90e93080b57"
        } );
        
        /* Set events handler */
        
        // when local user is connected to the server
        bc.signaling.bind( "onConnected", function () {
        // show pane with id "pane_1"
        showPanel( "pane_1" );
        } );
        
        // when an error occured on the server side
        bc.signaling.bind( "onError", function ( error ) {
        // display an alert message
        alert( error.text + " (" + error.code + ")" );
        } );
        
        // when the user has joined a room
        bc.signaling.bind( "onJoinedRoom", function ( data ) {
        // set the current room name
        room = data.room;
        members = data.members;
        // ask the user to access to his webcam
        bc.startStream( "webcam-sd", function( stream ){
            // affect stream to "localStream" var
            localStream = stream;
            // when webcam access has been granted
            // show pane with id "pane_2"
            showPanel( "pane_2" );
            // insert the local webcam stream into div#video_container node
            bc.attachStream( stream, q( "#video_container" ), { mirror: true } );
            // then, for every single members present in the room ...
            for ( var i=0, max=members.length; i<max; i++ ) {
               // ... request a call
               bc.call( members[ i ].id, room, { "stream": stream } );
           }
        } );
        } );
        
        // when an error occurred while trying to join a room
        bc.signaling.bind( "onJoinRoomError", function ( error ) {
        // display an alert message
        alert( error.text + " (" + error.code + ")" );
        } );
        
        // when the local user has quitted the room
        bc.signaling.bind( "onQuittedRoom", function( room ) {
        // stop the local stream
        bc.stopStream( localStream, function(){
           // remove the stream from the page
           bc.detachStream( localStream );
           // show pane with id "pane_1"
           showPanel( "pane_1" );
        } );
        } );
        
        // when a new remote stream is received
        bc.streams.bind( "onStreamAdded", function ( remoteStream ) {
        // insert the new remote stream into div#video_container node
        bc.attachStream( remoteStream, q( "#video_container_2" ) );
        } );
        
        // when a remote stream has been stopped
        bc.streams.bind( "onStreamClosed", function ( stream ) {
        // remove the stream from the page
        bc.detachStream( stream );
        } );
        
        // when a local stream cannot be retrieved
        bc.streams.bind( "onStreamError", function( error ){  
        switch( error.name ){
           case "PermissionDeniedError":
               alert( "Webcam access has not been allowed" );
               bc.quitRoom( room );
               break
           case "DevicesNotFoundError":
               if( confirm( "No webcam/mic found on this machine. Process call anyway ?" ) ){
                   // show pane with id "pane_2"
                   showPanel( "pane_2" );
                   for ( var i=0, max=members.length; i<max; i++ ) {
                       // ... request a call
                       bc.call( members[ i ].id, room );
                   }
               }
               else{
                   bc.quitRoom( room );  
               }
               break
        }
        } );
        
        // bind function "joinConference" to button "Join Conference Room"
        q( "#join" ).addEventListener( "click", joinConference );
        
        // bind function "quitConference" to button "Quit Conference Room"
        q( "#quit" ).addEventListener( "click", quitConference );
        
        // open a new session on the server
        bc.connect();
        }
        
        // when button "Join Conference Room" has been clicked
        function joinConference(){
        var roomToJoin = "rapRoom";
        // if "Conference Name" field is not empty ...
        if( roomToJoin ){
        // ... join the room
        bc.joinRoom( roomToJoin );
        }
        else{
        // otherwise, display an alert
        alert( "you must enter a room name !" )
        }  
        }
        
        // when button "Quit Conference Room" has been clicked
        function quitConference(){
        // quit the current conference room
        bc.quitRoom( room );
        }
        
        function showPanel( id ){
        var panes = document.querySelectorAll( ".pane" );
        // for all nodes matching the query ".pane"
        for( var i=0, max=panes.length; i<max; i++ ){
        // hide all nodes except the one to show
        panes[ i ].style.display = panes[ i ].id == id ? "block" : "none";
        };
        }
        
        function q( query ){
        // return the DOM node matching the query
        return document.querySelector( query );
        }
        </script>
</head>
<body>
    <div class="container-fluid" style="height:90px ">
            <div>
                <h1 id="rap_live"><strong><em>Rap Live</strong></em></h1>
            </div>

     </div>
    <div class="pane" id="pane_1" style="display: block">
        
        <i class="em em-crown"></i>
 
        <input type="button" value="Rap Room" id="join" style="font-size: 20px">

        <i class="em em-crown"></i>
    </div>
   
    <div class="pane" id="pane_2" style="display: none">
        <div id="video_container"></div>
        <div id="video_container_2"></div>
        <input type="button" value="Leave Rap Room" id="quit" class="btn btn-danger btn-default btn-block">
    </div>

    <div class="beats">
        <h3 id="beat_selection">Beat Selection</h3>
        <iframe width="40%" height="15%" src="https://www.youtube.com/embed/l1G6EN_T0Ac?rel=0" 
        frameborder="0" allow="autoplay; encrypted-media" 
        allowfullscreen>
        </iframe>


        <iframe width="40%" height="15%" src="https://www.youtube.com/embed/icxdL0zvid8?rel=0" 
        frameborder="0" allow="autoplay; encrypted-media" 
        allowfullscreen>
        </iframe>


        <iframe width="40%" height="15%" src="https://www.youtube.com/embed/-X1QR6_UT-I?rel=0" 
        frameborder="0" allow="autoplay; encrypted-media" 
        allowfullscreen>
        </iframe>

        <iframe width="40%" height="15%" src="https://www.youtube.com/embed/N5cFI7_KmDc?rel=0" 
        frameborder="0" allow="autoplay; encrypted-media" 
        allowfullscreen>
        </iframe>

        
        <iframe width="40%" height="15%" src="https://www.youtube.com/embed/p7JCvniqcvk?rel=0" 
        frameborder="0" allow="autoplay; encrypted-media" 
        allowfullscreen>
        </iframe>


        <iframe width="40%" height="15%" src="https://www.youtube.com/embed/nTmIK7iFCEU?rel=0" 
        frameborder="0" allow="autoplay; encrypted-media" 
        allowfullscreen>
        </iframe>


        <iframe width="40%" height="15%" src="https://www.youtube.com/embed/SyXybR0bb18?rel=0" 
        frameborder="0" allow="autoplay; encrypted-media" 
        allowfullscreen>
        </iframe>


         <iframe width="40%" height="15%" src="https://www.youtube.com/embed/9r2yzxHwTR8?rel=0" 
        frameborder="0" 
        allow="autoplay; encrypted-media" 
        allowfullscreen>
        </iframe>

        
        <iframe width="40%" height="15%" src="https://www.youtube.com/embed/rT1mDwTDArY?rel=0" 
        frameborder="0" allow="autoplay; encrypted-media" 
        allowfullscreen>
        </iframe>

        <iframe width="40%" height="15%" src="https://www.youtube.com/embed/sYqWNocRIh8?rel=0" 
        frameborder="0" allow="autoplay; encrypted-media" 
        allowfullscreen>
        </iframe>

        <iframe width="40%" height="15%" src="https://www.youtube.com/embed/QkUoaeaaBi8?rel=0" 
        frameborder="0" allow="autoplay; encrypted-media" 
        allowfullscreen>
        </iframe>

        <iframe width="40%" height="15%" src="https://www.youtube.com/embed/KelY_40mQ9c?rel=0" 
        frameborder="0" allow="autoplay; encrypted-media" 
        allowfullscreen>
        </iframe>

        <iframe width="40%" height="15%" src="https://www.youtube.com/embed/vN6YBgccE-s?rel=0" 
        frameborder="0" allow="autoplay; encrypted-media" 
        allowfullscreen>
        </iframe>

        <iframe width="40%" height="15%" src="https://www.youtube.com/embed/HBntk3w-ExA?rel=0" 
        frameborder="0" allow="autoplay; encrypted-media" 
        allowfullscreen>
        </iframe>

        <iframe width="40%" height="15%" src="https://www.youtube.com/embed/JDFpxX1Xbxo?rel=0&amp;start=41" 
        frameborder="0" allow="autoplay; encrypted-media" 
        allowfullscreen>
        </iframe>

        <iframe width="40%" height="15%" src="https://www.youtube.com/embed/61qCCnQVsNs?rel=0" 
        frameborder="0" allow="autoplay; encrypted-media" 
        allowfullscreen>
        </iframe>

        <iframe width="40%" height="15%" src="https://www.youtube.com/embed/MfT4eXBvOag?rel=0" 
        frameborder="0" allow="autoplay; encrypted-media" 
        allowfullscreen>
        </iframe>

        <iframe width="40%" height="15%" src="https://www.youtube.com/embed/bQBw1fJuUtw?rel=0&amp;start=30" 
        frameborder="0" allow="autoplay; encrypted-media" 
        allowfullscreen>
        </iframe>

        <iframe width="40%" height="15%" src="https://www.youtube.com/embed/wcy-YDx9cv0?rel=0" 
        frameborder="0" allow="autoplay; encrypted-media" 
        allowfullscreen>
        </iframe>

        <iframe width="40%" height="15%" src="https://www.youtube.com/embed/NHTmgGTS-4E?rel=0" 
        frameborder="0" allow="autoplay; encrypted-media" 
        allowfullscreen>
        </iframe>

        <iframe width="40%" height="15%" src="https://www.youtube.com/embed/TOdwMx9jHFs?rel=0" 
        frameborder="0" allow="autoplay; encrypted-media" 
        allowfullscreen>
        </iframe>

        <iframe width="40%" height="15%" src="https://www.youtube.com/embed/exBt8x_OGk0?rel=0" 
        frameborder="0" allow="autoplay; encrypted-media" 
        allowfullscreen>
        </iframe>

        <iframe width="40%" height="15%" src="https://www.youtube.com/embed/Cysce7HE6us?rel=0" 
        frameborder="0" allow="autoplay; encrypted-media" 
        allowfullscreen>
        </iframe>

        <iframe width="40%" height="15%" src="https://www.youtube.com/embed/6oFe_-WaKkk?rel=0" 
        frameborder="0" allow="autoplay; encrypted-media" 
        allowfullscreen>
        </iframe>


        <iframe width="40%" height="15%" src="https://www.youtube.com/embed/7WjVOQ_0tq4?rel=0" 
        frameborder="0" allow="autoplay; encrypted-media" 
        allowfullscreen>
        </iframe>

        <iframe width="40%" height="15%" src="https://www.youtube.com/embed/0dxw4K0yqoM?rel=0" 
        frameborder="0" allow="autoplay; encrypted-media" 
        allowfullscreen>
        </iframe>

        <iframe width="40%" height="15%" src="https://www.youtube.com/embed/KtSn-mhwYGc?rel=0" 
        frameborder="0" 
        allow="autoplay; encrypted-media" 
        allowfullscreen>
        </iframe>


        <iframe width="40%" height="15%" src="https://www.youtube.com/embed/ROX4JpwmBtg?rel=0" 
        frameborder="0" allow="autoplay; encrypted-media" 
        allowfullscreen>
        </iframe>

        <iframe width="40%" height="15%" src="https://www.youtube.com/embed/pdq4NKGTD4M?rel=0&amp;start=9" 
        frameborder="0" allow="autoplay; encrypted-media" 
        allowfullscreen>
        </iframe>

        <iframe width="40%" height="15%" src="https://www.youtube.com/embed/C0IjKeb4Xq4?rel=0&amp;start=34" 
        frameborder="0" allow="autoplay; encrypted-media" 
        allowfullscreen>
        </iframe>

    </div>
</body>
</html>